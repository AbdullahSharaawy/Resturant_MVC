@model UserProfileDTO

@section HeaderLinks {
    <partial name="_HeaderLinks" />
}


<!-- Custom CSS -->
<style>
    :root {
        --primary-color: #cda45e;
        --secondary-color: #fff;
        --dark-bg: #0c0b09;
        --dark-card: #1a1814;
        --dark-border: #2a2723;
        --dark-text: #fff;
        --dark-muted: #aaaaaa;
    }

    body {
        font-family: "Poppins", sans-serif;
        background-color: var(--dark-bg);
        color: var(--dark-text);
    }

    .profile-section {
        background-color: var(--dark-card);
        border-radius: 8px;
        box-shadow: 0px 2px 15px rgba(0, 0, 0, 0.5);
        padding: 30px;
        margin-bottom: 30px;
        border: 1px solid var(--dark-border);
    }

    .profile-section-title {
        font-family: "Playfair Display", serif;
        font-weight: 600;
        font-size: 2rem;
        color: var(--primary-color);
        margin-bottom: 25px;
        position: relative;
        padding-bottom: 15px;
    }

        .profile-section-title:after {
            content: '';
            position: absolute;
            display: block;
            width: 50px;
            height: 3px;
            background: var(--primary-color);
            bottom: 0;
            left: 0;
        }

    .profile-img {
        width: 150px;
        height: 150px;
        object-fit: cover;
        border-radius: 50%;
        border: 5px solid var(--dark-card);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    }

    .profile-header {
        text-align: center;
        padding: 40px;
        background: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url('assets/img/hero-bg.jpg') center center;
        background-size: cover;
        color: white;
        border-radius: 8px;
        margin-bottom: 30px;
        border: 1px solid var(--dark-border);
    }

        .profile-header h2 {
            font-family: "Playfair Display", serif;
            font-weight: 700;
            font-size: 2.5rem;
            margin-top: 20px;
        }

        .profile-header p {
            color: rgba(255, 255, 255, 0.8);
        }

    /* Dark mode form controls */
    .form-control, .form-select {
        background-color: #24211b;
        border-color: #3a362e;
        color: var(--dark-text);
        border-radius: 4px;
    }

        .form-control:focus, .form-select:focus {
            background-color: #2a2721;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(205, 164, 94, 0.25);
            color: var(--dark-text);
        }

        .form-control::placeholder {
            color: var(--dark-muted);
        }

    /* Dark mode buttons */
    .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
        color: #1a1814;
        font-weight: 600;
        border-radius: 4px;
        padding: 10px 20px;
        transition: all 0.3s;
    }

        .btn-primary:hover {
            background-color: #d4af6a;
            border-color: #d4af6a;
            color: #1a1814;
        }

    .btn-outline-primary {
        color: var(--primary-color);
        border-color: var(--primary-color);
        background-color: transparent;
    }

        .btn-outline-primary:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: #1a1814;
        }

    .btn-outline-secondary {
        color: var(--dark-muted);
        border-color: var(--dark-border);
        background-color: transparent;
    }

        .btn-outline-secondary:hover {
            background-color: #2a2723;
            border-color: var(--dark-border);
        }

    /* Cards */
    .reservation-card, .order-card {
        background-color: var(--dark-card);
        border: 1px solid var(--dark-border);
        border-radius: 8px;
        box-shadow: 0px 2px 15px rgba(0, 0, 0, 0.5);
        transition: all 0.3s;
        margin-bottom: 20px;
    }

        .reservation-card:hover, .order-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
        }

        .reservation-card .card-header, .order-card .card-header {
            background-color: var(--primary-color);
            color: #1a1814;
            border-radius: 8px 8px 0 0 !important;
            padding: 15px 20px;
            border-bottom: 1px solid var(--dark-border);
            font-weight: 600;
        }

    .card-body {
        color: var(--dark-text);
        padding: 20px;
    }

    /* Badges */
    .badge-status {
        font-size: 0.8rem;
        padding: 5px 10px;
        border-radius: 20px;
        font-weight: 600;
    }

    .badge-confirmed {
        background-color: #28a745;
        color: white;
    }

    .badge-pending {
        background-color: #ffc107;
        color: #1a1814;
    }

    .badge-cancelled {
        background-color: #dc3545;
        color: white;
    }

    .badge-completed {
        background-color: #17a2b8;
        color: white;
    }

    /* Navigation */
    .nav-pills .nav-link.active {
        background-color: var(--primary-color);
        color: #1a1814;
        font-weight: 600;
    }

    .nav-pills .nav-link {
        color: var(--dark-muted);
        background-color: transparent;
        margin-bottom: 5px;
        border-radius: 4px;
        transition: all 0.3s;
    }

        .nav-pills .nav-link:hover {
            color: var(--dark-text);
            background-color: rgba(255, 255, 255, 0.05);
        }

    /* Order items */
    .order-item {
        border-bottom: 1px solid var(--dark-border);
        padding: 15px 0;
    }

        .order-item:last-child {
            border-bottom: none;
        }

    .order-item-img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 4px;
        border: 1px solid var(--dark-border);
    }

    /* Text colors */
    .text-muted {
        color: var(--dark-muted) !important;
    }

    hr {
        border-color: var(--dark-border);
    }

    /* Header and footer */
    .header {
        background-color: var(--dark-card);
        border-bottom: 1px solid var(--dark-border);
    }

    .footer {
        background-color: var(--dark-card);
        border-top: 1px solid var(--dark-border);
    }

    /* Form switches */
    .form-check-input {
        background-color: #3a362e;
        border-color: #4a453d;
    }

        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
    /* Error message styling (if you add validation messages) */
    .dark-form-container .text-danger {
        color: #dc3545 !important; /* Bootstrap danger red */
    }

    .modal-body {
        color: var(--dark-text);
    }

    .modal-content {
        background-color: var(--dark-card);
        border: 1px solid var(--dark-border);
        color: var(--dark-text);
    }

    .modal-header,
    .modal-footer {
        border-color: var(--dark-border);
    }

        .modal-header .btn-close {
            filter: invert(1) grayscale(100%) brightness(200%);
        }
    /* Responsive adjustments */
    @@media (max-width: 768px) {
        .profile-img {
            width: 120px;
            height: 120px;
        }

        .profile-section {
            padding: 20px;
        }
    }
   
</style>






<main id="main" class="main py-5 mt-5">
    <partial name="_NotificationModal" />
    <div class="container">
        <div class="row">
            <!-- Profile Sidebar -->
            <div class="col-lg-4">
                <div class="profile-header">
                    <img src="assets/img/testimonials/testimonials-1.jpg" alt="Profile Image" class="profile-img">
                    <h2>John Smith</h2>
                    <p>Member since 2023</p>
                </div>

                <div class="profile-section">
                    <ul class="nav nav-pills flex-column mb-3">
                        <li class="nav-item">
                            <a class="nav-link active" href="#profile" data-bs-toggle="pill" onclick="GetUserProfileInfoForm()">My Profile</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#QuickReservation" data-bs-toggle="pill" onclick="GetQuickResrvationForm()">Quick Reservation</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#orders" data-bs-toggle="pill" onclick="GetMyOrders()">My Orders</a>
                      
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#reservations" data-bs-toggle="pill" onclick="GetMyReservations()">My Reservations</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#settings" data-bs-toggle="pill" onclick="GetSettingsForm()">Settings</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/Account/SignOut">Logout</a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Profile Content -->
            <div class="col-lg-8">
                <div class="tab-content">
                    <!-- Profile Info Tab -->
                    <div class="tab-pane fade show active" id="profile">
                                          
                    </div>
                    <!--Quick Reservation Tab -->
                    <div class="tab-pane fade" id="QuickReservation">
                    </div>
                    <div class="tab-pane fade" id="reservations">
                         
                    </div>



                    <!-- Reservations Tab -->
                    <div class="tab-pane fade" id="reservations">
                     
                    </div>

                    <!-- Orders Tab -->
                    <div class="tab-pane fade" id="orders">
                         
                    </div>

                    <!-- Settings Tab -->
                    <div class="tab-pane fade" id="settings">
                                            
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

@section Scripts{
    <script>
        window.onload = function () {
            GetUserProfileInfoForm();
        };
        function GetUserProfileInfoForm() {
            event.preventDefault();

            $.ajax({
                url: "/UserProfile/UserProfileInfo", success: function (result) {
                    $("#profile").html(result);
                }
            });

        }
        function GetQuickResrvationForm() {
            event.preventDefault();

            $.ajax({
                url: "/Reservation/QuickReservationForm", success: function (result) {
                    $("#QuickReservation").html(result);
                }
            });

        }
        function GetSettingsForm() {
            event.preventDefault();

            $.ajax({
                url: "/Account/AccountSettings", success: function (result) {
                    $("#settings").html(result);
                }
            });

        }

        function GetMyReservations() {
            event.preventDefault();

            $.ajax({
                url: "/Reservation/MyReservations",
                success: function (result) {
                    $("#reservations").html(result);
                }
            });
        }
        function GetMyOrders() {
            event.preventDefault();
            $.ajax({
                url: "/Order/MyOrders",
                success: function (result) {
                    $("#orders").html(result);
                }
            });
        }

        $(document).on('submit', '#userProfileInfo', function (e) {
            e.preventDefault();

            $.ajax({
                url: '/UserProfile/SaveEditProfileInfo',
                type: 'POST',
                data: $(this).serialize(),
                success: function (response) {
                    if (response.success) {
                        // Immediately redirect to the confirmation page
                        window.location.href = response.redirectUrl;

                    } else {
                        $('#notificationModalLabel').text("Error");
                        $('#notificationModalBody').text(response.message);
                        $('#notificationModal').modal('show');
                    }
                },
                error: function () {
                    $('#notificationModalLabel').text("Error");
                    $('#notificationModalBody').text('Please enter valid data.');
                    $('#notificationModal').modal('show');
                }
            });
        });
        $(document).on('submit', '#quickReservationForm', function (e) {
            e.preventDefault(); // prevent page refresh
            console.log("hi");
            $.ajax({
                url: '/Reservation/SaveQuickReservation',
                type: 'POST',
                data: $(this).serialize(),
                success: function (response) {
                    if (response.success) {
                        // Set the message and show the modal
                        $('#notificationModalBody').text(response.message);
                        $('#notificationModal').modal('show');
                    } else {
                        
                        $('#notificationModalLabel').text("Error");
                        $('#notificationModalBody').text(response.message);
                        $('#notificationModal').modal('show');
                    }
                },
                error: function () {
                   
                    $('#notificationModalLabel').text("Error");
                    $('#notificationModalBody').text('Please enter a valid data.');
                    $('#notificationModal').modal('show');
                }
            });
        });
        $(document).on('submit', '#Settings', function (e) {
            e.preventDefault(); // prevent page refresh
            console.log("hi");
            $.ajax({
                url: '/Account/UpdateAccountSettings',
                type: 'POST',
                data: $(this).serialize(),
                success: function (response) {
                    if (response.success) {
                        // Set the message and show the modal
                        $('#notificationModalBody').text(response.message);
                        $('#notificationModal').modal('show');
                    } else {

                        $('#notificationModalLabel').text("Error");
                        $('#notificationModalBody').text(response.message);
                        $('#notificationModal').modal('show');
                    }
                },
                error: function () {

                    $('#notificationModalLabel').text("Error");
                    $('#notificationModalBody').text('Please enter a valid data.');
                    $('#notificationModal').modal('show');
                }
            });
        });
    </script>
}
